#!/bin/sh

echo "ğŸ” Running Gitleaks scan before push..."

# Adjust config file name if needed
CONFIG_FILE=".gitleaks.toml"

if [ ! -f "$CONFIG_FILE" ]; then
  echo "â— Gitleaks config not found: $CONFIG_FILE"
  exit 1
fi

gitleaks detect --config "$CONFIG_FILE" --no-git -v
EXIT_CODE=$?

if [ $EXIT_CODE -ne 0 ]; then
  echo "ğŸš« Gitleaks detected secrets. Push aborted."
  exit 1
fi

echo "âœ… Gitleaks passed. Proceeding with push..."
exit 0

